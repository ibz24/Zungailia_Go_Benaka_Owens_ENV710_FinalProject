## Effects of Land Use on Soil Moisture

```{r}
#Load packages
library(ggplot2)
library(GGally)
library(lme4)
```


```{r}
soil <- read.csv("soil.csv")
soil <- soil %>%
  #select(-row, -stake) %>%
  rename %>%
  mutate(soil = case_when(
    soil == "FF" ~ "Forest floor",
    soil == "MIN" ~ "Mineral soil",
    TRUE ~ soil)) %>%
  mutate(site = case_when(
    site == "P1" ~ "Plow 1",
    site == "P2" ~ "Plow 2",
    site == "S1" ~ "Pasture 1",
    site == "S2" ~ "Pasture 2",
    site == "W1" ~ "Woodlot 1",
    site == "W2" ~ "Woodlot 2",
    TRUE ~ site))

#Remove NAs
soil <- na.omit(soil)
#soil <- drop_na(soil$soil.moisture)
soil$stake <- as.factor(soil$stake)
soil$row <- as.factor(soil$row)
soil$site <- as.factor(soil$site)

#Visualize data
ggpairs(soil, c("site", "row", "stake", "soil", "soil.mass", "soil.moisture", "soil.moisture.capacity"))

#Count unique values for each variable
sapply(lapply(soil, unique), length)
  #soil variable only has one unique value (Forest floor) --> drop from model

#Create a model --> soil moisture as dependent variable
smois <- lmer(soil.moisture ~ site + (1|row) + (1|stake) + ff.thickness + bulk.density + soil.mass + ph.h2o + ph.cacl2 + c + n + om + p + nh4 + no3 + n.min + nitr + cec + ca + mg + k + soil.moisture + soil.moisture.capacity, data = soil)
summary(smois)


#smois2 <- lm(soil.moisture ~ site + (1|row) + (1|stake) + factor(soil) + factor(ff.thickness) + factor(bulk.density) + factor(soil.mass) + factor(ph.h2o) + factor(ph.cacl2) + factor(c) + factor(n) + factor(om) + factor(p) + factor(nh4) + factor(no3) + factor(n.min) + factor(nitr) + factor(cec) + factor(ca) + factor(mg) + factor(k) + factor(soil.moisture) + factor(soil.moisture.capacity), data = soil)
```

