---
title: "Nitrogen Analysis"
author: "Li Jia Go"
date: "2023-03-27"
output: pdf_document
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
library(ggplot2)
library(dplyr)
library(GGally)
library(lme4)
library(lmerTest)
library(car)
```

```{r}
soil <- read.csv("soil.csv")
soil <- soil %>%
  rename %>%
  mutate(soil = case_when(
    soil == "FF" ~ "Forest floor",
    soil == "MIN" ~ "Mineral soil",
    TRUE ~ soil)) %>%
  mutate(site = case_when(
    site == "P1" ~ "Plow 1",
    site == "P2" ~ "Plow 2",
    site == "S1" ~ "Pasture 1",
    site == "S2" ~ "Pasture 2",
    site == "W1" ~ "Woodlot 1",
    site == "W2" ~ "Woodlot 2",
    TRUE ~ site))

#Remove NAs
soil <- na.omit(soil)

#Factor classes
soil$stake <- as.factor(soil$stake)
soil$row <- as.factor(soil$row)
soil$site <- as.factor(soil$site)

#The data were analyzed by two-way factorial analysis of variance using land-use history (woodlot, pastured, or
#cultivated) as main effects and site and row as a covariate.

#full model
n2.1 <- lmer(n ~ factor(site) + (1|row) + (1|stake) + ff.thickness + bulk.density + soil.mass + ph.h2o + ph.cacl2 + c  + om + p + nh4 + no3 + n.min + nitr + cec + ca + mg + k + soil.moisture + soil.moisture.capacity, data = soil)
summary(n2.1)

n2.2 <- update(n2.1, .~. -p)
summary(n2.2)

n2.3 <- update(n2.2, .~. -cec)
summary(n2.3)

n2.4 <- update(n2.3, .~. -k)
summary(n2.4)

n2.5 <- update(n2.4, .~. -mg)
summary(n2.5)

n2.6 <- update(n2.5, .~. -ph.cacl2)
summary(n2.6)

n2.7 <- update(n2.6, .~. -n.min)
summary(n2.7)

n2.8 <- update(n2.7, .~. -nh4)
summary(n2.8)

n2.9 <- update(n2.8, .~. -ff.thickness)
summary(n2.9)

n2.10 <- update(n2.9, .~. -nitr)
summary(n2.10)

n2.11 <- update(n2.10, .~. -no3)
summary(n2.11)

n2.12 <- update(n2.11, .~. -ph.h2o)
summary(n2.12)

n2.13 <- update(n2.12, .~. -soil.moisture.capacity)
summary(n2.13)

n2.14 <- update(n2.13, .~. -om)
summary(n2.14)

n2.15 <- update(n2.14, .~. -soil.moisture)
summary(n2.15)

#best model
n2.16 <- update(n2.15, .~. -bulk.density)
summary(n2.16)

AIC(n2.1, n2.2, n2.3, n2.4, n2.5, n2.6, n2.7, n2.8, n2.9, n2.10, n2.11, n2.12, n2.13, n2.14, n2.15, n2.16)
```